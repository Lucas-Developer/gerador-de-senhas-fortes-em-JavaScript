<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt-br" lang="pt-br">
  <head>
    <title>Gerador de senhas</title>
    <meta name="author" content="Lucas | lucas_developer@tutamail.com" />
    <style type="text/css">
      <!--
      * {font: 11px Verdana}
      .campo1 {width: 180px}
      .campo2 {width: 40px}
      .campo1, .campo2 {border: solid 1px #CCC}
      .botao {border: solid 1px #BBB; background-color: #EEE; cursor: pointer}
      #aguarde {font-style: italic}
      -->
    </style>
  </head>
  <body>
    <form action="#" onsubmit="GerarSenha(); return false">
      Senha: <input type="text" name="senha" size="30" class="campo1" readonly="readonly" />&nbsp;&nbsp;
      <input type="submit" value="Gerar senha" class="botao" /><br /><br />
      Dígitos: <input type="text" value="20" name="digitos" size="3" class="campo2" maxlength="2" /> 
    </form><br />
    <div id="aguarde"></div> 
  </body>
  <script type="text/javascript">
      <!--
      // função dec2hex: converte números decimais em números hexadecimais 
      function dec2hex(randomNumber) {
        const base = 16;
        let digito = [];
        let value = "";
        let index = 0;
        let hexValues = [0, 1, 2, 3, 4, 5, 6, 7,8, 9, 'A', 'B', 'C', 'D', 'E', 'F'];
        while (randomNumber != 0) {
          index++;
          digito[i] = numero % base;
          randomNumber = Math.floor(numero / base);
        }
        while (index >= 1)  {
         value += hexValues[digito[index]];
         index--;
        }
        return value;
      }

      function GerarSenha() {
        document.forms[0].senha.value = "";
        tamanho = document.forms[0].digitos.value;

        // validar o campo *dígitos*
        if (tamanho < 1 || isNaN(tamanho)) {
          alert("Escolha um valor numérico válido para esse campo");
          document.forms[0].digitos.focus();
          document.forms[0].digitos.select();
          return;
        }

        // ajusta o tamanho (em pixels) do campo de acordo com o número de dígitos
        document.forms[0].senha.style.width = (tamanho * 9) + "px";

        // códigos ASCII decimais
        min = 32;
        max = 126;

        for (i = 1; i <= tamanho; i++) {
          caracter = min + Math.floor((Math.random() * (max - min)));  // 32 a 126
          caracter = "%" + dec2hex(caracter);
          caracter = unescape(caracter);
          document.forms[0].senha.value += caracter;
          document.getElementById("aguarde").innerHTML = "aguarde...";
        }
        document.getElementById("aguarde").innerHTML = "";
      }
      //-->
    </script>
</html>
